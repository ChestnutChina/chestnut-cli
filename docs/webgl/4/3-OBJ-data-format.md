## OBJ数据格式

大多数建模软件使用二进制数据以专有文件格式存储其模型数据，以最小化文件大小。如果数据要在建模程序之间共享，就需要一种跨平台的数据格式。一个这样的跨平台数据格式是由[Wavefront](https://en.wikipedia.org/wiki/Wavefront_Technologies)创建的OBJ文件格式。Blender可以导出和导入OBJ数据文件。我们将使用OBJ格式来为我们的WebGL程序定义模型，因为:
- OBJ文件是纯文本，这使得数据可以在JavaScript中被读取和解析。
- 纯文本格式消除了网络服务器和各种客户端浏览器之间的任何二进制不兼容问题。

### 从Blender导出OBJ数据

当你创建Blender模型时，总是将它们保存为Blender的原始格式，即使用.blend文件扩展名。这保证了如果你以后打开和编辑模型，可以检索到你的模型的所有属性。

当你准备在WebGL程序中使用一个模型时，请执行以下操作:

1. 确保每个模型都有一个不含空格的描述性名称。对于模型，你需要命名几何对象，而不是模型对象。(使用Outliner编辑器并展开对象来查看几何体)。
2. 选择 "文件 "菜单，"导出 "命令，以及 "波前（.obj）"子命令。
3. 输入一个适当的文件名。(名字中不要包含任何空格，并使用所有小写字母)。
4. 在左下角有一组导出的选项。你可能要拖动并展开面板才能看到所有的选项。设置的选项如下:
    - Forward：-Z向前"（这将使你的模型数据围绕X旋转-90度。）
    - Up："Y向上"（这将使你的模型数据围绕X旋转-90度。）
    - Write Normals：关闭 (为了使文件尽可能小。)
    - Include UV's：关闭（除非你定义了一个纹理贴图，我们将在后面介绍）。
    - Write Materials：打开（包括颜色数据）。
    - Triangulate Faces：打开（因为WebGL只渲染三角形。）
    - Objects as OBJ Objects：开启（这样对象就会被命名。）

    在下图中可以看到出口设置的一个例子：

    ![](/4/obj_export_options.png)
5. 选择右上角的“导出 OBJ”按钮。

同样，下面的例子告诉你Blender中模型的默认方向。

点击查看[交互式例子](http://learnwebgl.brown37.net/modelers/obj_data_format.html#exporting-obj-data-from-blender)

[在新的标签或窗口中打开这个webgl程序](http://learnwebgl.brown37.net/modelers/blender_orientation/blender_orientation.html)

注意：如果你想让你的模型完全按照设计时的样子导出，不改变方向，那么把Forward: 设置为Y向前，把Up: 设置为Z向上。

### 示例 OBJ 数据文件

下面的例子定义了一个简单的立方体。每行的第一个字符或关键字确定了该行的数据格式和类型。下面给出了例子中每个 "关键词 "的含义:

- \# - 评论，会被忽略
- mtllib - 材料定义文件的文件名
- o - 给出一个模型的名称。这一行和下一行o之间的所有数据都是一个单一的模型
- v - 定义单个顶点的x、y、z值
- usemtl - 对下面的多边形使用一个特定的颜色和材质定义。
- s - 关闭或打开平滑阴影；当平滑阴影关闭时，会使用平面阴影。
- f - 定义组成一个面的顶点。请注意，面可以有3个以上的顶点。在这个例子中，面有四个顶点，定义了四边形多边形。在WebGL渲染之前，这些必须被分割成三角形。

```js
# Blender v2.69 (sub 0) OBJ File: ''
# www.blender.org
mtllib model_cube01.mtl
o Cube
v  0.250000 -0.250000 -0.250000
v  0.250000 -0.250000  0.250000
v -0.250000 -0.250000  0.250000
v -0.250000 -0.250000 -0.250000
v  0.250000  0.250000 -0.250000
v  0.250000  0.250000  0.250000
v -0.250000  0.250000  0.250000
v -0.250000  0.250000 -0.250000
usemtl Red
s off
f 1 2 3 4
f 5 8 7 6
f 1 5 6 2
f 2 6 7 3
f 3 7 8 4
f 5 1 4 8
```

### 文件格式详细信息

OBJ 文件的所有细节都超出了这些教程的范围。如果您对更多细节感兴趣，http://paulbourke.net/dataformats/obj/ 是一个很好的参考。